<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>日本の文化史新聞</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Font: Noto Serif JP for a newspaper feel -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* Base styles */
        body {
            font-family: 'Noto Serif JP', serif;
            background-color: #f7f7f7;
        }
        /* Newspaper container styling */
        .newspaper-page {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border: 1px solid #ddd;
            background-color: #fff;
            padding: 1.5rem 1rem;
            margin-bottom: 2rem;
        }
        /* Newspaper headline style */
        .headline {
            border-bottom: 3px solid #000;
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
            line-height: 1.1;
        }
        /* Tap-to-explain word style */
        .key-term {
            font-weight: 700;
            cursor: pointer;
            text-decoration: underline;
            text-decoration-color: #ef4444; /* red-500 */
            text-underline-offset: 4px;
            text-decoration-thickness: 2px;
            transition: all 0.2s;
            /* body直下に配置するため、relative/inline-blockは不要だが、デザインのため残す */
            display: inline; 
            z-index: 10;
        }
        .key-term:hover {
            background-color: #fee2e2; /* red-100 */
        }

        /* Popover Bubble Styling */
        .popover-bubble {
            position: absolute; /* body基準で絶対配置 */
            z-index: 50;
            width: 280px;
            max-width: 90vw;
            background-color: #333;
            color: white;
            padding: 12px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            line-height: 1.5;
            text-align: left;
            font-size: 0.9rem;
            opacity: 0;
            /* transformを初期状態から設定 */
            transform: translate(-50%, 10px); 
            transition: opacity 0.2s, transform 0.2s;
            pointer-events: none;
        }

        .popover-bubble.visible {
            opacity: 1;
            pointer-events: auto;
            /* 表示時に位置を調整 (下表示なら下に10px移動した分を戻す) */
            transform: translate(-50%, 0); 
        }

        /* 上向き三角（吹き出しが単語の下に表示される場合）*/
        .popover-bubble.bottom::before {
            content: '';
            position: absolute;
            bottom: 100%; /* 上側に配置 */
            left: 50%;
            transform: translateX(-50%);
            border: 8px solid transparent;
            border-bottom-color: #333;
        }
        /* 下向き三角（吹き出しが単語の上に表示される場合）*/
        .popover-bubble.top::before {
            content: '';
            position: absolute;
            top: 100%; /* 下側に配置 */
            left: 50%;
            transform: translateX(-50%);
            border: 8px solid transparent;
            border-top-color: #333;
        }
    </style>
</head>
<body class="p-4 lg:p-8">

    <div class="max-w-4xl mx-auto mb-12">
        <h1 class="text-4xl font-extrabold text-center mb-2 text-gray-800">日本文化史特報</h1>
        <p class="text-center text-sm text-gray-600 border-b pb-4">重要単語をタップ！詳細な解説が吹き出しで表示されます</p>
    </div>

    <!-- 1. 明治時代（Meiji Period） -->
    <section id="meiji" class="newspaper-page rounded-xl">
        <header class="text-center mb-4">
            <div class="text-sm font-bold text-red-700">【第一報】明治三十年代</div>
            <h2 class="headline text-4xl font-bold mt-1 mb-2">大改革の波！列強に追いつけ</h2>
            <p class="text-sm font-light text-gray-700">東京日報 特別号外</p>
        </header>

        <div class="content-cols text-base leading-relaxed text-gray-800">
            <p class="indent-4 mb-4">
                明治維新以降、日本は急速な近代化の道を歩み、西洋文化を積極的に取り入れました。これを<span class="key-term" data-term="文明開化" onclick="togglePopover(event, '文明開化')">文明開化</span>と呼びます。蒸気機関車やガス灯、洋風建築が都市部に現れ、人々の生活は一変。髪型を洋式にしたり、牛肉を食したりする新しい風習が広まりました。
            </p>
            <p class="indent-4 mb-4">
                教育面でも、<span class="key-term" data-term="学制" onclick="togglePopover(event, '学制')">学制</span>（1872年）が発布され、近代的な学校制度が整えられました。資料によれば、当時14歳以下の人口は420万人とされ、国民の多くはまだ学問に触れる機会が少なかった時代でしたが、教育の普及は国家の最重要課題とされました。
            </p>
            <p class="indent-4">
                哲学や政治思想の分野でも、自由民権運動を背景に西洋の概念が流入し、知識階級を中心に、伝統的な価値観と新しい価値観との間で大きな衝突が生まれました。
            </p>
        </div>
        <!-- 画像Placeholder -->
        <div class="text-center mt-6 p-4 bg-gray-100 rounded-lg text-sm text-gray-600 italic">
            
        </div>
    </section>

    <!-- 2. 大正時代（Taisho Period） -->
    <section id="taisho" class="newspaper-page rounded-xl">
        <header class="text-center mb-4">
            <div class="text-sm font-bold text-blue-700">【第二報】大正初～中期</div>
            <h2 class="headline text-4xl font-bold mt-1 mb-2">デモクラシーと個性の開花</h2>
            <p class="text-sm font-light text-gray-700">文化新報 大正拾弐年号</p>
        </header>

        <div class="content-cols text-base leading-relaxed text-gray-800">
            <p class="indent-4 mb-4">
                大正時代は「大正デモクラシー」と呼ばれる自由主義的な風潮が広がり、個人の尊重や解放が求められました。文学の世界では、自己の内面を探求する<span class="key-term" data-term="ロマン主義" onclick="togglePopover(event, 'ロマン主義')">ロマン主義</span>が全盛期を迎えました。
            </p>
            <p class="indent-4 mb-4">
                また、社会の矛盾への関心から、貧困や格差を分析する<span class="key-term" data-term="マルクス主義" onclick="togglePopover(event, 'マルクス主義')">マルクス主義</span>などの社会主義思想が知識人、特に学生の間で支持を拡大しました。資料にも「人文学」「ロシアス」といった記述があり、海外の新しい思想が大きな影響を与えたことが窺えます。
            </p>
            <p class="indent-4">
                この時期に特筆すべきは、文化が一部のエリート層から一般大衆へと広がる<span class="key-term" data-term="大衆文化" onclick="togglePopover(event, '大衆文化')">大衆文化</span>の誕生です。都市生活者の増加とともに、娯楽への需要が高まり、映画や演劇、そして後の<span class="key-term" data-term="ラジオ放送" onclick="togglePopover(event, 'ラジオ放送')">ラジオ放送</span>がその担い手となりました。
            </p>
        </div>
        <!-- 画像Placeholder -->
        <div class="text-center mt-6 p-4 bg-gray-100 rounded-lg text-sm text-gray-600 italic">
            
        </div>
    </section>

    <!-- 3. 昭和時代（Showa Period: 戦時下〜戦後復興） -->
    <section id="showa" class="newspaper-page rounded-xl">
        <header class="text-center mb-4">
            <div class="text-sm font-bold text-green-700">【第三報】昭和激動の時代</div>
            <h2 class="headline text-4xl font-bold mt-1 mb-2">戦後復興と生活様式の変貌</h2>
            <p class="text-sm font-light text-gray-700">平和新聞 昭和三十年代号</p>
        </header>

        <div class="content-cols text-base leading-relaxed text-gray-800">
            <p class="indent-4 mb-4">
                昭和初期の軍国主義の時代には、文化・言論は厳しい<span class="key-term" data-term="戦時統制" onclick="togglePopover(event, '戦時統制')">戦時統制</span>下に置かれました。文学者や芸術家は戦争協力の道を選ばされるか、表現の自由を奪われました。
            </p>
            <p class="indent-4 mb-4">
                しかし終戦後、文化は大きな転換期を迎えます。GHQによる民主化政策と同時に、失われた文化を守るための活動が重要視され、1950年には<span class="key-term" data-term="文化財保護法" onclick="togglePopover(event, '文化財保護法')">文化財保護法</span>が制定されました。
            </p>
            <p class="indent-4 mb-4">
                そして、1950年代半ばからは<span class="key-term" data-term="高度経済成長" onclick="togglePopover(event, '高度経済成長')">高度経済成長</span>期に突入します。テレビ、冷蔵庫、洗濯機といった「三種の神器」が普及し、人々の生活水準は飛躍的に向上しました。都市部では<span class="key-term" data-term="ビルディング" onclick="togglePopover(event, 'ビルディング')">ビルディング</span>が林立し、「TOKYO 1064」といった標語が生まれるなど、急速な社会変化を遂げました。資料にあるように<span class="key-term" data-term="カレーライス" onclick="togglePopover(event, 'カレーライス')">カレーライス</span>の普及など、食生活の洋風化も進みました。
            </p>
        </div>
        <!-- 画像Placeholder -->
        <div class="text-center mt-6 p-4 bg-gray-100 rounded-lg text-sm text-gray-600 italic">
            
        </div>
    </section>

    <script>
        // 定義する単語とその説明
        const terms = {
            "文明開化": {
                title: "文明開化（ぶんめいかいか）",
                description: "明治時代初期に、西洋の文化、制度、技術を積極的に取り入れ、生活様式や社会構造を近代化しようとした現象。福沢諭吉の『学問のすすめ』などが代表的。"
            },
            "学制": {
                title: "学制（がくせい）",
                description: "1872年（明治5年）に発布された、近代的な教育制度に関する法令。身分に関係なくすべての国民を対象とした小学校教育の普及を目指した。"
            },
            "ロマン主義": {
                title: "ロマン主義（ロマンしゅぎ）",
                description: "大正時代に主流となった文学・芸術の潮流。個人の感情や自我の尊重、理想や自由の追求をテーマとする。島崎藤村や北原白秋などが有名。"
            },
            "マルクス主義": {
                title: "マルクス主義（マルクスしゅぎ）",
                description: "カール・マルクスが提唱した思想体系。資本主義社会の矛盾や階級闘争を分析し、社会主義・共産主義社会の実現を目指す。大正・昭和初期の知識人に大きな影響を与えた。"
            },
            "大衆文化": {
                title: "大衆文化（たいしゅうぶんか）",
                description: "新聞、雑誌、映画、ラジオなどの新しいメディアの発展により、一部のエリート層だけでなく、一般大衆に広く共有されるようになった文化。"
            },
            "ラジオ放送": {
                title: "ラジオ放送（ラジオほうそう）",
                description: "1925年（大正14年）に東京で開始された本放送。家庭に情報や娯楽を届ける新しいメディアとして急速に普及し、大衆文化の発展に不可欠な役割を果たした。"
            },
            "戦時統制": {
                title: "戦時統制（せんじとうせい）",
                description: "日中戦争・太平洋戦争下で、国家が物資や産業、言論、文化活動などを管理・制限した体制。すべての国民生活が戦争遂行のために動員された。"
            },
            "文化財保護法": {
                title: "文化財保護法（ぶんかざいほごほう）",
                description: "1950年（昭和25年）に制定された法律。火災で焼失した法隆寺金堂などの教訓から、日本の貴重な文化財（有形・無形）の保存と活用を目的にしている。"
            },
            "高度経済成長": {
                title: "高度経済成長（こうどけいざいせいちょう）",
                description: "1950年代半ばから1970年代初頭にかけての、日本のGDPが年平均10%前後の高い成長率を記録した期間。生活水準が向上し、社会構造が大きく変化した。"
            },
            "ビルディング": {
                title: "ビルディング（Building）",
                description: "高層建築物。高度経済成長期には、都市再開発やオリンピックなどを背景に、次々と高層ビルが建設され、都市景観の象徴となった。"
            },
            "カレーライス": {
                title: "カレーライス",
                description: "明治時代に西洋から伝わり、大正・昭和にかけて国民食として普及した。特に戦後の給食を通じて、一般家庭の食卓に定着した。"
            }
        };

        let currentPopover = null; // 現在表示中の吹き出し要素を保持

        // 吹き出しを閉じる関数
        function closePopover() {
            if (currentPopover) {
                // アニメーションのためにvisibleクラスを外し、非表示にする
                currentPopover.classList.remove('visible');
                
                // 完了後にDOMから削除 (この処理を確実にする)
                const popoverToRemove = currentPopover;
                currentPopover = null;

                popoverToRemove.addEventListener('transitionend', function handler() {
                    if (popoverToRemove.parentElement) {
                        popoverToRemove.parentElement.removeChild(popoverToRemove);
                    }
                    popoverToRemove.removeEventListener('transitionend', handler);
                }, { once: true });
            }
        }
        
        // 吹き出しの表示/非表示を切り替える関数
        function togglePopover(event, termKey) {
            // イベントのバブリングを停止し、bodyへのクリックイベントが発火しないようにする
            event.stopPropagation();
            
            const clickedElement = event.currentTarget;
            const data = terms[termKey];

            // 1. 既に吹き出しが開いていれば閉じる（別要素がクリックされた場合も含む）
            if (currentPopover) {
                // 同じ要素が再度クリックされた場合は閉じて終了
                if (currentPopover.dataset.termKey === termKey) {
                    closePopover();
                    return;
                }
                // 別の要素がクリックされた場合は、まず既存のものを閉じる
                closePopover();
            }
            
            // 2. 新しい吹き出しを作成し、body直下に配置
            const popover = document.createElement('div');
            popover.className = 'popover-bubble';
            popover.dataset.termKey = termKey; // どの単語の吹き出しかを識別するためにキーを保存

            const title = data.title || termKey;
            popover.innerHTML = `<p class="font-bold mb-1">${title}</p><p>${data.description}</p>`;
            document.body.appendChild(popover);
            currentPopover = popover;

            // 3. ポップアップの位置調整
            const rect = clickedElement.getBoundingClientRect();
            const popoverWidth = 280; // CSSで定義された幅
            const popoverHeight = 150; // 仮の高さ (中身によって変わるため、多めに設定)
            const margin = 10;
            const arrowSize = 8;
            
            // ポップアップの中心X座標
            const centerX = rect.left + rect.width / 2;
            
            // ----------------------------------------------------
            // 縦位置 (デフォルト: 下)
            let isDisplayingOnTop = false;
            // 単語の上端から上方向に向かってポップアップを表示するのに十分なスペースがあるか確認
            if (rect.top - popoverHeight - margin < 0) {
                // スペースがない場合は下に表示
                popover.style.top = `${rect.bottom + arrowSize}px`;
                popover.classList.add('bottom');
            } else {
                // スペースがある場合は上に表示
                popover.style.top = `${rect.top - popoverHeight - arrowSize}px`;
                popover.classList.add('top');
                isDisplayingOnTop = true;
            }
            // ----------------------------------------------------
            
            // ----------------------------------------------------
            // 横位置 (デフォルト: 中央寄せ)
            let finalLeft = centerX - popoverWidth / 2;
            
            // 左端からはみ出す場合
            if (finalLeft < margin) {
                finalLeft = margin;
            }
            
            // 右端からはみ出す場合
            const popoverRightEdge = finalLeft + popoverWidth;
            if (popoverRightEdge > window.innerWidth - margin) {
                finalLeft = window.innerWidth - popoverWidth - margin;
            }
            
            popover.style.left = `${finalLeft}px`;

            // 三角の位置調整 (ポップアップのleftからの相対位置で計算)
            const arrowLeftOffset = centerX - finalLeft;
            const arrowElement = popover.querySelector('.top, .bottom');
            if (arrowElement) {
                arrowElement.style.left = `${arrowLeftOffset}px`;
                arrowElement.style.transform = 'translateX(-50%)'; // 中心に固定
            }
            // ----------------------------------------------------

            // 4. 表示を確定し、アニメーションを開始
            // ポップアップの最終的な高さが確定したら、上に表示している場合はtopを再計算する
            if (isDisplayingOnTop) {
                // DOMに追加され、幅が確定した後、高さを再取得
                const actualHeight = popover.offsetHeight;
                popover.style.top = `${rect.top - actualHeight - arrowSize}px`;
            }

            // 描画サイクルを待ってからvisibleクラスを付与
            requestAnimationFrame(() => {
                popover.classList.add('visible');
            });

            // 5. クリックイベントが吹き出し内から発火しても閉じる処理を止めない
            popover.addEventListener('click', (e) => e.stopPropagation());
        }


        // DOMが完全にロードされた後に、画面外クリックのイベントリスナーを設定
        document.addEventListener('DOMContentLoaded', () => {
            
            // 画面外（body）をクリックしたときに吹き出しを閉じるイベントを設定
            document.body.addEventListener('click', (event) => {
                // クリックされた要素がkey-termクラスを持たない、かつ、現在吹き出しが表示されていれば閉じる
                if (currentPopover && !event.target.closest('.key-term')) {
                    closePopover();
                }
            });

             // ウィンドウサイズが変更されたら、開いている吹き出しを閉じる
            window.addEventListener('resize', closePopover);
        });
    </script>
</body>
</html>
